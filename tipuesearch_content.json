{"pages":[{"url":"http://scumer.com/about","text":"email:scumer@126.com","tags":"Miscellaneous","loc":"http://scumer.com/about","title":"About"},{"url":"http://scumer.com/python-gdcm-scu","text":"使用python gdcm编写dicom scu,c-find/c-move/c-store 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 def _getQuery ( kwargs ): queryKeys = gdcm . DataSet () for key in kwargs : if key != studyUIDTag : continue de = gdcm . DataElement () de . SetTag ( key ) de . SetByteValue ( kwargs [ key ], gdcm . VL ( len ( kwargs [ key ]))) queryKeys . Insert ( de ) #ePatientRootType,eStudyRootType # ePatient,eStudy,eSeries,eImage query = gdcm . CompositeNetworkFunctions_ConstructQuery ( gdcm . eStudyRootType , gdcm . eStudy , queryKeys , True ) return query scu = gdcm . ServiceClassUser () scu . SetHostname ( MOVE_CONFIG [ 'host' ]) scu . SetPort ( MOVE_CONFIG [ 'port' ]) scu . SetTimeout ( 100 ) scu . SetCalledAETitle ( MOVE_CONFIG [ 'callAE' ]) scu . SetAETitle ( MOVE_CONFIG [ 'callingAE' ]) scu . SetPortSCP ( MOVE_CONFIG [ 'retrievePort' ]) query = _getQuery ( { studyUIDTag : studyUID , seriesUIDTag : seriesUID , sopUIDTag : sopUID }) print 'query:' , query . ValidateQuery () print 'InitializeConnection:' , scu . InitializeConnection () generator = gdcm . PresentationContextGenerator () generator . GenerateFromUID ( query . GetAbstractSyntaxUID ()) # !!! scu . SetPresentationContexts ( generator . GetPresentationContexts ()) if scu . StartAssociation (): # print 'Echo:',scu.SendEcho() res = gdcm . DataSetArrayType () # if scu.SendFind(query, res): if scu . SendMove ( query , MOVE_CONFIG [ 'path' ]): pass # for dataset in res: # print dataset.GetDataElement(studyUIDTag) # print dataset.GetDataElement(seriesUIDTag) # print dataset.GetDataElement(sopUIDTag) scu . StopAssociation ()","tags":"Python","loc":"http://scumer.com/python-gdcm-scu","title":"Python GDCM SCU"}]}